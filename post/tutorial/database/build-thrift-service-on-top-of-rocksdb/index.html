<!doctype html><html class=no-js lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#ffffff"><title>Build Thrift Service on top of RocksDB - We Are No Dev</title><script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script><meta name=description content="Mình đã build Thrift service (a RPC Framework) on top of RocksDB (an embeddable persistent key-value storage) như một database sử dụng cho một số projects khi làm việc tại Zalo. Hiệu năng mà RocksDB cùng với Thrift mang lại kết quả khá tuyệt vời với khả năng đọc ghi dữ liệu cao, phù hợp sử dụng cho các tools mình thực hiện tại Zalo khi không yêu cầu sử dụng DB nội bộ của công ty."><meta property="og:title" content="Build Thrift Service on top of RocksDB"><meta property="og:description" content="Mình đã build Thrift service (a RPC Framework) on top of RocksDB (an embeddable persistent key-value storage) như một database sử dụng cho một số projects khi làm việc tại Zalo. Hiệu năng mà RocksDB cùng với Thrift mang lại kết quả khá tuyệt vời với khả năng đọc ghi dữ liệu cao, phù hợp sử dụng cho các tools mình thực hiện tại Zalo khi không yêu cầu sử dụng DB nội bộ của công ty."><meta property="og:type" content="article"><meta property="og:url" content="/post/tutorial/database/build-thrift-service-on-top-of-rocksdb/"><meta property="article:published_time" content="2020-12-05T00:00:00+00:00"><meta property="article:modified_time" content="2020-12-05T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Build Thrift Service on top of RocksDB"><meta name=twitter:description content="Mình đã build Thrift service (a RPC Framework) on top of RocksDB (an embeddable persistent key-value storage) như một database sử dụng cho một số projects khi làm việc tại Zalo. Hiệu năng mà RocksDB cùng với Thrift mang lại kết quả khá tuyệt vời với khả năng đọc ghi dữ liệu cao, phù hợp sử dụng cho các tools mình thực hiện tại Zalo khi không yêu cầu sử dụng DB nội bộ của công ty."><link rel=icon type=image/png href=/favicon.png><link rel=apple-touch-icon href=/favicon.png><meta name=msapplication-TileImage content="/favicon.png"><link href="https://fonts.googleapis.com/css2?family=Muli:ital,wght@0,400;0,500;0,700;0,800;1,400&display=swap" rel=stylesheet><link href=/vendor/font-awesome/4.7.0/css/font-awesome.min.css rel=stylesheet><link rel=stylesheet href=/css/style.min.3593336bd12106f4ab3d37ce2fd3db6b.css integrity="md5-NZMza9EhBvSrPTfOL9Pbaw=="><link rel=stylesheet href=/css/spacing_helpers.min.css><link rel=stylesheet href=/css/custom.css><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-162061519-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=body><div class="container container--outer"><header class=header><div class=container><div class=logo><a href=/ title="We Are No Dev" rel=home><img src=/favicon.png alt="We Are No Dev" class=header__favicon></a>
<a class=logo__link href=/ title="We Are No Dev" rel=home><div class=logo__title>We Are No Dev</div><div class=logo__tagline>We are NOT ONLY Developers</div></a><img src=/img/outline-banner.png alt="We Are No Dev" class=header__banner_img></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/about/><span class=menu__text>About</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>Build Thrift Service on top of RocksDB</h1><div class="post__meta meta"><div class="meta__item meta__item-lang"><i class=meta__icon><img src=/icon/vi64.png alt=vi width=16px></i>
<span class=meta__text>Vietnamese</span></div><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2020-12-05T00:00:00Z>Dec 05, 2020</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/database/ rel=category>Database</a></span></div></div></header><div class="post__toc toc toc_mobile"><div class=toc__title>Table of contents</div><div class=toc__menu><nav id=TableOfContents><ul><li><a href=#1-overview>1. Overview</a><ul><li><a href=#11-rocksdb>1.1. RocksDB</a></li><li><a href=#12-thrift-service>1.2. Thrift Service</a></li></ul></li><li><a href=#2-implementation>2. Implementation</a><ul><li><a href=#21-partitions>2.1. Partitions</a></li><li><a href=#22-key-and-value-types>2.2. Key and Value Types</a></li><li><a href=#23-range-types>2.3. Range Types</a></li><li><a href=#24-map-types>2.4. Map Types</a></li><li><a href=#25-supported-apis>2.5. Supported APIs</a></li><li><a href=#26-thrift-client-wrapper>2.6. Thrift Client Wrapper</a></li></ul></li><li><a href=#3-benchmarking>3. Benchmarking</a></li><li><a href=#4-conclusion>4. Conclusion</a></li></ul></nav></div></div><div class="content post__content clearfix"><p>Mình đã build <a href=https://thrift.apache.org/>Thrift service</a> (<strong>a RPC Framework</strong>) on top of <a href=https://rocksdb.org/>RocksDB</a> (<strong>an embeddable persistent key-value storage</strong>) như một database sử dụng cho một số projects khi làm việc tại <a href=https://zalo.careers/>Zalo</a>. Hiệu năng mà RocksDB cùng với Thrift mang lại kết quả khá tuyệt vời với <strong>khả năng đọc ghi dữ liệu cao</strong>, phù hợp sử dụng cho các tools mình thực hiện tại Zalo khi không yêu cầu sử dụng DB nội bộ của công ty.</p><h2 id=1-overview>1. Overview</h2><p>Trước hết, mình xin đề cập đến lý do tại sao mình lại chọn <a href=https://rocksdb.org/>RocksDB</a> để làm <em><strong>embeded database</strong></em> cho con Thrift service của mình. Chuyện là khi mình còn trong giai đoạn Fresher tại Zalo, khi đó mình có task về việc tracking dữ liệu (dữ liệu gì thì mình không tiện đề cập), với lượng dữ liệu khá cao (<strong>hơn 3000 req/s</strong>). Rõ ràng các DB khác như MySQL hay MongoDB không đáp ứng được nhu cầu này. Đối với Zalo, con DB nội bộ dư sức xử lý mấy loại này, tuy nhiên do mình còn là Fresher cũng như task này không quá quan trọng đối với công ty nên mình không được cấp các DB này. Thế là sau một thời gian tìm kiếm trên Google, mình đã tìm được <a href=https://rocksdb.org/>RocksDB</a>, một con embbeded DB mang lại cho mình khá nhiều tin tưởng, vì là một Open Source từ Facebook, forked ra từ <a href=https://github.com/google/leveldb>LevelDB</a> của Google, cũng như được sử dụng làm innerDB (engine storage) trong một vài con DB khác.</p><p>Còn với lý do mình lại wrap con RocksDB trong một Thrift Service vì</p><ul><li>Zalo chủ yếu sử dụng Thrift làm RPC framework cho các micro-services</li><li>Phục vụ khả năng đọc ghi từ nhiều service khác, chứ RocksDB là in-process DB (chỉ 1 process có thể write trên DB này)</li></ul><h3 id=11-rocksdb>1.1. RocksDB</h3><div class="center m-t-20 m-b-20"><img src=https://i.imgur.com/KxONoMD.jpg alt width=400px decoding=async></div><p>Giới thiệu ngắn gọn qua về <strong>RocksDB</strong></p><ul><li>Một <strong>key-value</strong> storage</li><li>Sử dụng <strong>Log Structured Database Engine</strong></li><li>Hiện thực bằng <strong>C++</strong></li><li>Hỗ trợ <strong>JNI</strong> - <strong>Java Wrapper</strong></li><li>Hỗ trợ <a href=https://github.com/facebook/rocksdb/wiki/Column-Families>Column-Family</a> cho việc <strong>partition</strong> dữ liệu trong 1 process</li><li>Key được <strong>sort</strong> trong lưu trữ, có thể <strong>prefix seek key</strong>, <strong>iterate theo key</strong>.</li></ul><p>RocksDB cung cấp tài liệu trên <a href=https://github.com/facebook/rocksdb/wiki/Basic-Operations>Github</a> về cách hiện thực, lưu trữ và sử dụng. Các bạn có thể (nên) đọc về loại DB này nếu thực sự muốn sử dụng nó.</p><h3 id=12-thrift-service>1.2. Thrift Service</h3><p><a href=https://thrift.apache.org/>Apache Thrift</a> là một <strong>RPC framework</strong>, cho các <strong>mircro-services</strong> tương tác với nhau với khả năng <strong>cross-language</strong>, tức các ngôn ngữ khác nhau có thể gọi mà không thông cần các protocol mức cao hơn (HTTP cũng là một protocol cho phép các ngôn ngữ khác nhau có thể giao tiếp, nhưng sử dụng JSON như cầu nối cho các ngôn ngữ này). Ngoài ra Thrift còn cho phép <strong>code generation</strong>, tạo nhiều thuận tiện khi làm việc trên nhiều ngôn ngữ.</p><p>Tại Zalo, Thrift được sử dụng khá nhiều và phổ biến, và cũng đã được <em>custom</em>, <em>build sẵn</em> rất nhiều <em>lib nội bộ</em> và <em>config tối ưu</em>, từ <strong>thrift server</strong> cho đến <strong>thrift client</strong> (hay còn gọi là <strong>wrapper</strong>, cho phép bất kì service nào cũng có thể gọi đến các thrift server). Trong bài viết này, mình cũng dựa trên Thrift tại Zalo để build 1 Thrift server wrap lại con RocksDB và bộ Thrift client (client wrapper) phục vụ và hỗ trợ nhiều loại cho con server của mình.</p><h2 id=2-implementation>2. Implementation</h2><p>Do mình đã hiện thực build dựa trên Thrift đã custom của Zalo nên mình không thể share cũng như public được cả thrift server và thrift client, tuy nhiên mình có thể chia sẻ về những gì mình đã hiện thực.</p><p>Như mình đã đề cập, RocksDB hỗ trợ JNI hay Java Wrapper, do đó cho phép ta dễ dàng build một Thrift service bằng Java (do mình chủ yếu làm việc với <strong>Java</strong> và sử dụng các <strong>tool profiler</strong> tại Zalo). Về Java Wrapper mà RocksDB cnug cấp, mình xin để lại <a href=https://github.com/facebook/rocksdb/wiki/RocksJava-Basics>link tại đây</a>.</p><p>Mô hình sẽ được thể hiện như hình sau, trong đó thrift server sẽ <strong>mở 2 port,</strong> <strong>1 port config</strong>, <strong>1 port read/write</strong>, với <strong>phân quyền</strong> <strong>read/write/config</strong> cho các clients gọi vào.</p><div class="center m-t-20 m-b-20"><img src=/img/post/rocksdb/Thrift-RocksDB.png alt="Thrift RocksDB" width=100% decoding=async></div><h3 id=21-partitions>2.1. Partitions</h3><p>Vấn đề đầu tiên mà chúng ta cần lưu ý ở RocksDB chính là hỗ trợ <a href=https://github.com/facebook/rocksdb/wiki/Column-Families>Column-Family</a>, khả năng phân tách tập DB ra nhiều loại, có thể hình dung như tables trong SQL hay collections trong MongoDB.</p><p>Do đó trong Thrift service mình dự định build cũng cần hỗ trợ việc partition này. Các partition mình để giá trị <code>integer</code> hay <code>i32</code> trong Thrift</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#66d9ef>typedef</span> i32    TPartition
</code></pre></div><h3 id=22-key-and-value-types>2.2. Key and Value Types</h3><p>Trong RocksDB, key và value là dữ liệu binary, do đó trong Thrift tương ứng cũng là <code>binary</code> (hay <code>ByteBuffer</code> trong Java)</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#66d9ef>typedef</span> binary TKey
<span style=color:#66d9ef>typedef</span> binary TValue
</code></pre></div><p>Mình định nghĩa thêm các structs dưới đây cho việc định danh dữ liệu dễ dàng, phục vụ cho multiget, map result, &mldr; Trong đó <code>master</code> được đính kèm thêm phân vùng mà key-value nằm trên RocksDB</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>TMasterKey</span> {
    <span style=color:#ae81ff>1</span><span style=color:#f92672>:</span>required TPartition partition,
    <span style=color:#ae81ff>2</span><span style=color:#f92672>:</span>required TKey key,
}

<span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>TData</span> {
	<span style=color:#ae81ff>1</span><span style=color:#f92672>:</span>required TKey key,
	<span style=color:#ae81ff>2</span><span style=color:#f92672>:</span>required TValue value,
}

<span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>TMasterData</span> {
	<span style=color:#ae81ff>1</span><span style=color:#f92672>:</span>required TPartition partition,
	<span style=color:#ae81ff>2</span><span style=color:#f92672>:</span>required TKey key,
	<span style=color:#ae81ff>3</span><span style=color:#f92672>:</span>required TValue value,
}
</code></pre></div><h3 id=23-range-types>2.3. Range Types</h3><p>Như mình đã đề cập, RocksDB hỗ trợ iterate theo tập key, do đó một kiểu dữ liệu cần hỗ trợ là list theo key và list theo data (key-value) như sau</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#66d9ef>typedef</span> list<span style=color:#f92672>&lt;</span>TKey<span style=color:#f92672>&gt;</span> TListKey
<span style=color:#66d9ef>typedef</span> list<span style=color:#f92672>&lt;</span>TValue<span style=color:#f92672>&gt;</span> TListValue
<span style=color:#66d9ef>typedef</span> list<span style=color:#f92672>&lt;</span>TData<span style=color:#f92672>&gt;</span> TListData

<span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>TKeyRangeResult</span> {
	<span style=color:#ae81ff>1</span><span style=color:#f92672>:</span>required i32 error,
	<span style=color:#ae81ff>2</span><span style=color:#f92672>:</span>optional i32 offset, <span style=color:#75715e>// offset from seek key
</span><span style=color:#75715e></span>	<span style=color:#ae81ff>3</span><span style=color:#f92672>:</span>optional i32 total, <span style=color:#75715e>// total keys in result
</span><span style=color:#75715e></span>	<span style=color:#ae81ff>4</span><span style=color:#f92672>:</span>optional TListKey keys, <span style=color:#75715e>// list keys are iterated
</span><span style=color:#75715e></span>}

<span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>TDataRangeResult</span> {
	<span style=color:#ae81ff>1</span><span style=color:#f92672>:</span>required i32 error,
	<span style=color:#ae81ff>2</span><span style=color:#f92672>:</span>optional i32 offset, <span style=color:#75715e>// offset from seek key
</span><span style=color:#75715e></span>	<span style=color:#ae81ff>3</span><span style=color:#f92672>:</span>optional i32 total, <span style=color:#75715e>// total keys in result
</span><span style=color:#75715e></span>	<span style=color:#ae81ff>4</span><span style=color:#f92672>:</span>optional TListData data, <span style=color:#75715e>// list key-value are iterated
</span><span style=color:#75715e></span>}
</code></pre></div><h3 id=24-map-types>2.4. Map Types</h3><p>RocksDB cũng hộ trợ multiget theo key, do đó ta cần kiểu map theo key</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#66d9ef>typedef</span> map<span style=color:#f92672>&lt;</span>TMasterKey, TValue<span style=color:#f92672>&gt;</span> TMapData
<span style=color:#66d9ef>typedef</span> map<span style=color:#f92672>&lt;</span>TMasterKey, i32<span style=color:#f92672>&gt;</span> TMapError

<span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>TMapDataResult</span> {
	<span style=color:#ae81ff>1</span><span style=color:#f92672>:</span>required i32 error, <span style=color:#75715e>// last error, useful to check if all data are retrieved successfully or not
</span><span style=color:#75715e></span>	<span style=color:#ae81ff>2</span><span style=color:#f92672>:</span>optional map<span style=color:#f92672>&lt;</span>TKey, TValue<span style=color:#f92672>&gt;</span> dataMap,
	<span style=color:#ae81ff>3</span><span style=color:#f92672>:</span>optional map<span style=color:#f92672>&lt;</span>TKey, i32<span style=color:#f92672>&gt;</span> errorMap, <span style=color:#75715e>// for check error of any fail data
</span><span style=color:#75715e></span>}
</code></pre></div><h3 id=25-supported-apis>2.5. Supported APIs</h3><p>Các APIs thrift mình hỗ trợ dưa trên RocksDB hỗ trợ gồm (mình chỉ ghi tượng trưng, không đúng syntax trong thrift)</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp>service ZRocksDBService {

	exist(TPartition, TKey)
	get(TPartition, TKey)

	<span style=color:#75715e>// multi get by key
</span><span style=color:#75715e></span>	multiGet(TPartition, TListKey)

	<span style=color:#75715e>// iterate by key
</span><span style=color:#75715e></span>	scanKey(TPartition, TKey seekKey, offset, limit)
	scan(TPartition, TKey seekKey, offset, limit)
	
	<span style=color:#75715e>// RocksDB: flush to disk
</span><span style=color:#75715e></span>	syn_put(TPartition, TKey, TValue, PutPolicy add_or_update)
	syn_remove(TPartition, TKey)
	syn_removeRange(TPartition, TKey beginKey, TKey endKey)
	
	<span style=color:#75715e>// RocksDB: async
</span><span style=color:#75715e></span>	put(TPartition, TKey, TValue, PutPolicy add_or_update)
	remove(TPartition, TKey)
	removeRange(TPartition, TKey beginKey, TKey endKey)

	<span style=color:#75715e>// one-way in Thrift
</span><span style=color:#75715e></span>	ow_put(TPartition, TKey, TValue, PutPolicy add_or_update)
	ow_remove(TPartition, TKey)
	ow_removeRange(TPartition, TKey beginKey, TKey endKey)

	<span style=color:#75715e>// config service
</span><span style=color:#75715e></span>	backup(TBackupOptionParam)
}
</code></pre></div><p>Việc hiện thực chi tiết con server mình sẽ không public ở đây, tuy nhiên căn bản là gọi các API từ RocksDB đã build sẵn.</p><h3 id=26-thrift-client-wrapper>2.6. Thrift Client Wrapper</h3><p>Đối với Thrift client cho việc gọi sang con thrift server, mình sẽ hỗ trợ tận răng các APIs build sẵn, cho phép <strong>define key-value types</strong>, phân vùng partition để dễ dàng sử dụng các client này, không cần trải qua các bước <strong>serialize/deserialize</strong> cục <code>binary</code> từ <em>key/value</em>. Việc này cũng khá dễ dàng.</p><h2 id=3-benchmarking>3. Benchmarking</h2><p>Mình đã thử benchmark cho <strong>khả năng đọc/ghi</strong> dữ liệu của con Thrift server</p><ul><li><strong>Server</strong>: <code>24</code> CPUs, RAM <code>128GB</code></li><li><strong>Clients</strong>: <code>3</code> nodes, mỗi node <code>8</code> CPUs, RAM <code>8G</code></li></ul><p>Mỗi client nodes mình thực hiện <strong>3 java process</strong>, mỗi process là một client gọi sang server:</p><ul><li><strong>Put 4000 req/s</strong></li><li><strong>Get 4000 req/s</strong></li></ul><p>Server mình profiler được thì hoàn toàn có thể xử lý đồng thời <strong>put 36K req/s</strong> và <strong>get 36K req/s</strong>.</p><p>Mình nhận ra <strong>giới hạn này là do phía client</strong> không thể xử lý hơn được nữa, do cấu hình tương đối, nếu có thêm client node, mình có thể dễ dàng scale ra để tăng req/s này lên mức cao hơn. Tuy nhiên khả năng như trên cũng đã cho mình kết quả khá đẹp :D.</p><h2 id=4-conclusion>4. Conclusion</h2><p>Túm lại mình đã build thành công <strong>một con Thrift service trên RocksDB</strong>, có thể sử dụng rộng ra cho nhiều dự án nhỏ khác, dễ dàng cho phép nhiều bên truy cập và xử lý dữ liệu thông qua con thrift này.</p><p>Mình cũng đã benchmark về hiệu năng trên một con server tương đối mạnh, cho kết quả <strong>put 36K req/s</strong> và <strong>get 36K req/s</strong> rất chi là khả quan.</p><p><strong>Các vấn đề</strong> khác mình còn vướng phải và cần phát triển hơn</p><ul><li>Làm thế nào để <strong>scale</strong> 1 node ra nhiều nodes như một <strong>cluster DB</strong>?</li><li><strong>Time-to-live</strong> cho DB, làm thế nào để roll dữ liệu không dùng nữa.</li><li>Cải thiện performance của DB khi thực hiện <strong>delete</strong></li><li>Tách rời Thrift và tool profiler của Zalo để có thể <strong>public source</strong> cho mọi người phát triển và sử dụng.</li></ul><p>Cảm ơn các bạn đã đọc đến dòng này của bài viết này. Nếu các bạn có thắc mắc gì thì có thể liên hệ mình hoặc feedback trong khung chat dưới đây để có thể dễ dàng trao đổi và phát triển nhiều hơn.</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5.0 11V3C0 1.5.8.8.8.8S1.5.0 3 0h8c1.5.0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 100-6 3 3 0 000 6z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/rocksdb/ rel=tag>RocksDB</a></li><li class=tags__item><a class="tags__link btn" href=/tags/thrift/ rel=tag>Thrift</a></li><li class=tags__item><a class="tags__link btn" href=/tags/java/ rel=tag>Java</a></li><li class=tags__item><a class="tags__link btn" href=/tags/database/ rel=tag>Database</a></li></ul></div></footer></article></main><div class="authorbox clearfix"><figure class=authorbox__avatar><img alt="Ha. Huynh Sam avatar" src=/img/avatar.png class=avatar height=90 width=90></figure><div class=authorbox__header><span class=authorbox__name></span></div><div class=authorbox__description>HaHS's true identity is unknown. Maybe he is a successful blogger or writer. Nobody knows it. Do you know him? Let me know that 😉.</div></div><nav class="post-nav flex"><div class="post-nav__item post-nav__item--prev"><a class=post-nav__link href=/post/tutorial/security/tong-hop-top-10-loi-bao-mat-owasp-2017/ rel=prev><span class=post-nav__caption>«&#8201;Previous</span><p class=post-nav__post-title>Tổng hợp top 10 lỗi bảo mật từ OWASP báo cáo năm 2017</p></a></div></nav><section class=comments><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"wearenodev"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></div><aside class=sidebar><div class="post__toc toc toc_sidebar m-t-30 m-b-50"><div class=toc__title>Table of contents</div><div class=toc__menu><nav id=TableOfContents><ul><li><a href=#1-overview>1. Overview</a><ul><li><a href=#11-rocksdb>1.1. RocksDB</a></li><li><a href=#12-thrift-service>1.2. Thrift Service</a></li></ul></li><li><a href=#2-implementation>2. Implementation</a><ul><li><a href=#21-partitions>2.1. Partitions</a></li><li><a href=#22-key-and-value-types>2.2. Key and Value Types</a></li><li><a href=#23-range-types>2.3. Range Types</a></li><li><a href=#24-map-types>2.4. Map Types</a></li><li><a href=#25-supported-apis>2.5. Supported APIs</a></li><li><a href=#26-thrift-client-wrapper>2.6. Thrift Client Wrapper</a></li></ul></li><li><a href=#3-benchmarking>3. Benchmarking</a></li><li><a href=#4-conclusion>4. Conclusion</a></li></ul></nav></div></div><div class="widget-recent widget"><h4 class=widget__title>Recent Posts</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=/post/tutorial/database/build-thrift-service-on-top-of-rocksdb/>Build Thrift Service on top of RocksDB</a></li><li class=widget__item><a class=widget__link href=/post/tutorial/security/tong-hop-top-10-loi-bao-mat-owasp-2017/>Tổng hợp top 10 lỗi bảo mật từ OWASP báo cáo năm 2017</a></li><li class=widget__item><a class=widget__link href=/post/tutorial/network/tom-tat-su-khac-biet-giua-cac-version-cua-http-1.0-1.1-2.0/>Tóm tắt sự khác biệt giữa các version của HTTP 1.0, 1.1 và 2.0</a></li><li class=widget__item><a class=widget__link href=/post/tutorial/elasticsearch/discord-da-thiet-lap-elasticsearch-ntn-de-index-hang-ty-messages/>Discord đã thiết lập Elasticsearch như thế nào để có thể index hàng tỷ messages?</a></li><li class=widget__item><a class=widget__link href=/post/tutorial/elasticsearch/monitor-your-elasticsearch-cluster-with-grafana-and-prometheus/>Monitor your Elasitcsearch Cluster with Grafana and Prometheus</a></li><li class=widget__item><a class=widget__link href=/post/tutorial/javascript/advance/vietnamese-search-in-datatables/>Tìm kiếm dữ liệu Tiếng Việt không dấu trong DataTables</a></li></ul></div></div><div class="widget-categories widget"><h4 class=widget__title>Categories</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=/categories/cloud/>Cloud</a></li><li class=widget__item><a class=widget__link href=/categories/database/>Database</a></li><li class=widget__item><a class=widget__link href=/categories/elasticsearch/>Elasticsearch</a></li><li class=widget__item><a class=widget__link href=/categories/heroku/>Heroku</a></li><li class=widget__item><a class=widget__link href=/categories/java/>Java</a></li><li class=widget__item><a class=widget__link href=/categories/javascript/>JavaScript</a></li><li class=widget__item><a class=widget__link href=/categories/linux/>Linux</a></li><li class=widget__item><a class=widget__link href=/categories/network/>Network</a></li><li class=widget__item><a class=widget__link href=/categories/nodejs/>NodeJS</a></li><li class=widget__item><a class=widget__link href=/categories/security/>Security</a></li></ul></div></div><div class="widget-taglist widget"><h4 class=widget__title>Tags</h4><div class=widget__content><a class="widget-taglist__link widget__link btn" href=/tags/adminlte2/ title=AdminLTE2>AdminLTE2 (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/aws/ title=AWS>AWS (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/aws-ec2/ title="AWS - EC2">AWS - EC2 (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/cloud/ title=Cloud>Cloud (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/database/ title=Database>Database (2)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/elasticsearch/ title=Elasticsearch>Elasticsearch (2)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/elasticsearch-monitoring/ title="Elasticsearch Monitoring">Elasticsearch Monitoring (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/google-apis/ title="Google APIs">Google APIs (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/grafana/ title=Grafana>Grafana (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/heroku-deployment/ title="Heroku Deployment">Heroku Deployment (2)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/http/ title=HTTP>HTTP (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/java/ title=Java>Java (4)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/java-basic/ title="Java Basic">Java Basic (3)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/java-thread/ title="Java Thread">Java Thread (3)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/javascript/ title=JavaScript>JavaScript (2)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/javascript-advance/ title="JavaScript Advance">JavaScript Advance (2)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/jsrmvi/ title=jsrmvi>jsrmvi (2)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/linux/ title=Linux>Linux (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/memcached/ title=Memcached>Memcached (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/mongodb/ title=MongoDB>MongoDB (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/mongoose/ title=Mongoose>Mongoose (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/network/ title=Network>Network (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/nodejs/ title=NodeJS>NodeJS (5)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/nodejs-advance/ title="NodeJS Advance">NodeJS Advance (3)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/nodejs-deployment/ title="NodeJS Deployment">NodeJS Deployment (2)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/npm/ title=NPM>NPM (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/owasp/ title=OWASP>OWASP (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/pgadmin/ title=pgAdmin>pgAdmin (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/postgresql/ title=PostgreSQL>PostgreSQL (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/prometheus/ title=Prometheus>Prometheus (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/robomongo/ title=Robomongo>Robomongo (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/rocksdb/ title=RocksDB>RocksDB (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/security/ title=Security>Security (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/sequelize/ title=Sequelize>Sequelize (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/thrift/ title=Thrift>Thrift (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/ubuntu/ title=Ubuntu>Ubuntu (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/vietnamese/ title=Vietnamese>Vietnamese (2)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/vietnamese-search/ title="Vietnamese Search">Vietnamese Search (1)</a>
<a class="widget-taglist__link widget__link btn" href=/tags/webpack/ title=Webpack>Webpack (1)</a></div></div><span class="widget-social widget m-b-15"><h4 class="widget-social__title widget__title">Social</h4><div class="widget-social__content widget__content"><span class="widget-social__item widget__item"><a class="widget-social__link widget__link btn btn-social-github" title=GitHub rel="noopener noreferrer" href=https://github.com/WeAreNoDev target=_blank><i class="fa fa-github-square"></i></a></span><span class="widget-social__item widget__item"><a class="widget-social__link widget__link btn btn-social-twitter" title=Twitter rel="noopener noreferrer" href=https://twitter.com/huynhsamha target=_blank><i class="fa fa-twitter-square"></i></a></span><span class="widget-social__item widget__item"><a class="widget-social__link widget__link btn btn-social-email" title=Email href=mailto:huynhsamha@gmail.com><i class="fa fa-envelope-square"></i></a></span><span class="widget-social__item widget__item"><a class="widget-social__link widget__link btn btn-social-linkedin" title=LinkedIn rel="noopener noreferrer" href=https://linkedin.com/in/huynhsamha target=_blank><i class="fa fa-linkedin-square"></i></a></span></div></span></aside></div><footer class=footer><div class="container footer__container"><div class=footer__copyright>WeAreNoDev &copy; 2020<div><span class=footer__copyright-credits>Made with<i class="fa fa-heart m-l-5 m-r-5" style=color:#eb0025></i>by
<a href=https://github.com/huynhsamha target=_blank>Ha. Huynh Sam</a></span></div></div></div></footer></div><span id=scroll-top><i class="fa fa-caret-up"></i></span><script src=/vendor/jquery/3.5.1/jquery.min.js></script><script src=/vendor/smooth-scroll/dist/smooth-scroll.polyfills.min.js></script><script type=text/javascript src=/js/main.min.f422027a0caaf9eadab59acbeb7e0d9a.js integrity="md5-9CICegyq+eratZrL634Nmg=="></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script></body></html>